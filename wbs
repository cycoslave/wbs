#!/usr/bin/env python3
# wbs (main.py)
"""
WBS Launcher
"""

import argparse
import asyncio
import json
import logging
import sys
import os
from src.core import Core

logging.basicConfig(level=logging.INFO, format='%(asctime)s %(levelname)s %(message)s')
logger = logging.getLogger(__name__)

def parse_args():
    parser = argparse.ArgumentParser(prog="wbs")
    parser.add_argument("-f", "--foreground", action="store_true")
    parser.add_argument("-c", "--config", default="config.json")
    parser.add_argument("-d", "--db-path")
    return parser.parse_args()

def load_config(config_path, db_path_override=None):
    with open(config_path) as f:
        config = json.load(f)
    if db_path_override:
        config['db']['path'] = db_path_override
    return config

def main():
    args = parse_args()
    core = Core(args=args)
    asyncio.run(core.run(foreground=args.foreground))

if __name__ == '__main__':
    main()